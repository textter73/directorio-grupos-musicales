<div class="registro-container">
  <header class="registro-header">
    <h1>Registrar AgrupaciÃ³n Musical</h1>
    <button class="btn-volver" (click)="volver()">â† Volver</button>
  </header>

  <div class="success-message" *ngIf="success">
    <h2>Â¡Solicitud Enviada!</h2>
    <p>Tu solicitud ha sido enviada correctamente. SerÃ¡ revisada por nuestro equipo.</p>
    <p>SerÃ¡s redirigido automÃ¡ticamente...</p>
  </div>

  <form *ngIf="!success" (ngSubmit)="onSubmit()" class="registro-form">
    <!-- 1. InformaciÃ³n BÃ¡sica -->
    <div class="form-section">
      <h3>ğŸ“ InformaciÃ³n BÃ¡sica</h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="nombre">Nombre de la AgrupaciÃ³n *</label>
          <input type="text" id="nombre" [(ngModel)]="agrupacion.nombre" name="nombre" required>
        </div>
        
        <div class="form-group">
          <label for="tipo">Tipo de AgrupaciÃ³n *</label>
          <select id="tipo" [(ngModel)]="agrupacion.tipo" name="tipo" required>
            <option value="">Selecciona...</option>
            <option value="estudiantina">Estudiantina</option>
            <option value="tuna">Tuna</option>
            <option value="rondalla">Rondalla</option>
            <option value="coro">Coro</option>
            <option value="mariachi">Mariachi</option>
            <option value="otro">Otro</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="anoFundacion">AÃ±o de FundaciÃ³n</label>
          <input type="number" id="anoFundacion" [(ngModel)]="agrupacion.anoFundacion" name="anoFundacion" min="1900" max="2024" placeholder="Ej: 2010">
        </div>
        
        <div class="form-group">
          <label for="numeroIntegrantes">NÃºmero de Integrantes</label>
          <input type="number" id="numeroIntegrantes" [(ngModel)]="agrupacion.numeroIntegrantes" name="numeroIntegrantes" min="1" max="100" placeholder="Ej: 15">
        </div>
      </div>
    </div>

    <!-- 2. UbicaciÃ³n -->
    <div class="form-section">
      <h3>ğŸ“ UbicaciÃ³n</h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="estado">Estado *</label>
          <select id="estado" [(ngModel)]="agrupacion.estado" name="estado" (change)="onEstadoChange()" required>
            <option value="">Selecciona un estado...</option>
            <option *ngFor="let estado of estados" [value]="estado">{{ estado }}</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="codigoPostal">CÃ³digo Postal</label>
          <input type="text" id="codigoPostal" [(ngModel)]="agrupacion.codigoPostal" name="codigoPostal" placeholder="Ej: 01000" maxlength="5" pattern="[0-9]{5}">
        </div>
      </div>

      <div class="form-group">
        <label for="municipio">Municipio/DelegaciÃ³n</label>
        <select id="municipio" [(ngModel)]="agrupacion.municipio" name="municipio" [disabled]="!agrupacion.estado">
          <option value="">{{ agrupacion.estado ? 'Selecciona un municipio...' : 'Primero selecciona un estado' }}</option>
          <option *ngFor="let municipio of getMunicipios()" [value]="municipio">{{ municipio }}</option>
        </select>
      </div>
    </div>

    <!-- 3. InformaciÃ³n de Contacto -->
    <div class="form-section">
      <h3>ğŸ‘¤ InformaciÃ³n de Contacto</h3>
      
      <div class="form-group">
        <label for="contacto">Nombre del Contacto *</label>
        <input type="text" id="contacto" [(ngModel)]="agrupacion.contacto" name="contacto" required>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="email">Email *</label>
          <input type="email" id="email" [(ngModel)]="agrupacion.email" name="email" required>
        </div>
        
        <div class="form-group">
          <label for="telefono">ğŸ“± TelÃ©fono con WhatsApp</label>
          <input type="tel" id="telefono" [(ngModel)]="agrupacion.telefono" name="telefono" placeholder="Ej: +52 55 1234 5678">
          <small class="field-hint">Ingresa un nÃºmero que tenga WhatsApp activo</small>
        </div>
      </div>
    </div>

    <!-- 4. InformaciÃ³n Musical -->
    <div class="form-section">
      <h3>ğŸµ InformaciÃ³n Musical</h3>
      
      <div class="form-group">
        <label for="descripcion">DescripciÃ³n de la AgrupaciÃ³n</label>
        <textarea id="descripcion" [(ngModel)]="agrupacion.descripcion" name="descripcion" rows="3" placeholder="Describe tu agrupaciÃ³n, historia, estilo..."></textarea>
      </div>
      
      <div class="form-group">
        <label for="repertorio">Repertorio Principal</label>
        <textarea id="repertorio" [(ngModel)]="agrupacion.repertorio" name="repertorio" rows="3" placeholder="Describe el tipo de mÃºsica que interpretan..."></textarea>
      </div>
    </div>

    <!-- 5. Redes Sociales -->
    <div class="form-section">
      <h3>ğŸ“± Redes Sociales</h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="facebook">ğŸ‘¥ Facebook</label>
          <input type="url" id="facebook" [(ngModel)]="agrupacion.facebook" name="facebook" placeholder="https://facebook.com/tu-agrupacion">
        </div>
        
        <div class="form-group">
          <label for="instagram">ğŸ“· Instagram</label>
          <input type="url" id="instagram" [(ngModel)]="agrupacion.instagram" name="instagram" placeholder="https://instagram.com/tu-agrupacion">
        </div>
      </div>
      
      <div class="form-group">
        <label for="tiktok">ğŸµ TikTok</label>
        <input type="url" id="tiktok" [(ngModel)]="agrupacion.tiktok" name="tiktok" placeholder="https://tiktok.com/@tu-agrupacion">
      </div>
    </div>

    <div class="form-section">
      <h3>Imagen de la AgrupaciÃ³n *</h3>
      
      <div class="image-upload-section">
        <div class="upload-area" *ngIf="!imagePreview">
          <input type="file" id="imagen" (change)="onFileSelected($event)" accept=".jpg,.jpeg,.png" hidden #fileInput>
          <button type="button" class="btn-upload" (click)="fileInput.click()">
            ğŸ“· Seleccionar Imagen *
          </button>
          <p class="upload-hint">Formatos: JPG, PNG solamente (mÃ¡x. 5MB)</p>
        </div>
        
        <div class="image-preview" *ngIf="imagePreview">
          <img [src]="imagePreview" alt="Vista previa">
          <div class="image-actions">
            <button type="button" class="btn-change" (click)="fileInput.click()">Cambiar</button>
            <button type="button" class="btn-remove" (click)="removeImage()">Eliminar</button>
          </div>
          <input type="file" id="imagen" (change)="onFileSelected($event)" accept=".jpg,.jpeg,.png" hidden #fileInput>
        </div>
        

      </div>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn-submit" [disabled]="!isFormValid() || loading">
        {{ loading ? 'Enviando...' : 'Enviar Solicitud' }}
      </button>
    </div>
  </form>
</div>